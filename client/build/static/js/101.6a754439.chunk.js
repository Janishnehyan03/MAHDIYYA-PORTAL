"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[101],{21101:function(e,t,l){l.r(t);var r=l(61819),n=l(15861),s=l(70885),a=l(72791),i=l(9085),o=l(59286),d=l(96562),c=l(54483),u=l(53174),m=l(80184),f=function(e){var t=e.file;return t?(0,m.jsx)("p",{className:"text-sm text-gray-700 font-medium truncate",children:t.name}):(0,m.jsx)("p",{className:"text-sm text-gray-500",children:"No file selected."})};t.default=function(){var e=(0,a.useContext)(d.V).authData,t=(0,a.useState)(null),l=(0,s.Z)(t,2),x=l[0],p=l[1],b=(0,a.useState)(""),h=(0,s.Z)(b,2),g=h[0],v=h[1],y=(0,a.useState)(""),j=(0,s.Z)(y,2),w=j[0],N=j[1],F=(0,a.useState)([]),k=(0,s.Z)(F,2),Z=k[0],A=k[1],C=(0,a.useState)(!0),S=(0,s.Z)(C,2),D=S[0],_=S[1],G=(0,a.useState)(!1),L=(0,s.Z)(G,2),M=L[0],T=L[1],E=(0,a.useState)(null),U=(0,s.Z)(E,2),z=U[0],B=U[1],I=(0,a.useCallback)((0,n.Z)((0,r.Z)().mark((function e(){var t,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _(!0),e.prev=1,e.next=4,o.Z.get("/downloads");case 4:t=e.sent,l=t.data,A(l),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Failed to fetch downloads:",e.t0),i.Am.error("Could not fetch downloads list.");case 13:return e.prev=13,_(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,9,13,16]])}))),[]);(0,a.useEffect)((function(){I()}),[I]);var P=function(){var e=(0,n.Z)((0,r.Z)().mark((function e(t){var l,n,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),g&&w&&x){e.next=4;break}return i.Am.warn("Please fill all fields and select a file."),e.abrupt("return");case 4:return T(!0),(l=new FormData).append("file",x),l.append("title",g),l.append("type",w),e.prev=9,e.next=12,o.Z.post("/downloads",l);case 12:return i.Am.success("File uploaded successfully!"),v(""),N(""),p(null),document.getElementById("formFile")&&(document.getElementById("formFile").value=""),e.next=16,I();case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(9),console.error("File upload error:",e.t0.response),i.Am.error((null===(n=e.t0.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message)||"An error occurred during upload.");case 22:return e.prev=22,T(!1),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[9,18,22,25]])})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=(0,n.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete this file? This action cannot be undone.")){e.next=18;break}return B(t),e.prev=2,A((function(e){return e.filter((function(e){return e._id!==t}))})),e.next=6,o.Z.delete("/downloads/".concat(t));case 6:i.Am.success("File deleted successfully."),e.next=15;break;case 9:return e.prev=9,e.t0=e.catch(2),i.Am.error("Failed to delete file. Please refresh and try again."),console.error("Delete error:",e.t0.response),e.next=15,I();case 15:return e.prev=15,B(null),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[2,9,15,18]])})));return function(t){return e.apply(this,arguments)}}();return(0,m.jsx)("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-6 lg:p-8",children:(0,m.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,m.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-8 text-center",children:"Manage Downloads"}),"superAdmin"===(null===e||void 0===e?void 0:e.role)&&(0,m.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-md mb-10 max-w-2xl mx-auto",children:[(0,m.jsx)("h2",{className:"text-xl font-semibold text-gray-700 mb-4 border-b pb-3",children:"Upload a New File"}),(0,m.jsxs)("form",{onSubmit:P,className:"space-y-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700",children:"File Type"}),(0,m.jsxs)("select",{id:"type",value:w,onChange:function(e){return N(e.target.value)},className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,m.jsx)("option",{value:"",disabled:!0,children:"Choose a category"}),(0,m.jsx)("option",{value:"student",children:"For Students"}),(0,m.jsx)("option",{value:"admin",children:"For Admins"})]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"file-title",className:"block text-sm font-medium text-gray-700",children:"File Title"}),(0,m.jsx)("input",{type:"text",id:"file-title",value:g,onChange:function(e){return v(e.target.value)},placeholder:"e.g., Annual Report 2023",className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"formFile",className:"block text-sm font-medium text-gray-700",children:"Select File"}),(0,m.jsx)("input",{type:"file",id:"formFile",onChange:function(e){return p(e.target.files[0])},className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),(0,m.jsx)("div",{className:"mt-2",children:(0,m.jsx)(f,{file:x})})]}),(0,m.jsx)("div",{className:"pt-2",children:(0,m.jsxs)("button",{type:"submit",disabled:M,className:"w-full inline-flex justify-center items-center gap-2 py-2.5 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-400 disabled:cursor-not-allowed",children:[(0,m.jsx)(c.G,{icon:M?u.LM3:u.cf$,spin:M}),M?"Uploading...":"Upload File"]})})]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Available Files"}),D?(0,m.jsxs)("div",{className:"text-center p-10",children:[(0,m.jsx)(c.G,{icon:u.LM3,spin:!0,size:"2x",className:"text-blue-500"}),(0,m.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading Files..."})]}):Z.length>0?(0,m.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Z.map((function(t){return(0,m.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-5 flex flex-col justify-between hover:shadow-lg transition-shadow",children:[(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,m.jsx)("span",{className:"px-2.5 py-1 text-xs font-medium text-blue-800 bg-blue-100 rounded-full capitalize",children:t.type}),"superAdmin"===(null===e||void 0===e?void 0:e.role)&&(0,m.jsx)("button",{onClick:function(){return $(t._id)},disabled:z===t._id,className:"text-gray-400 hover:text-red-600 disabled:cursor-not-allowed p-1","aria-label":"Delete file",children:(0,m.jsx)(c.G,{icon:z===t._id?u.LM3:u.$aW,spin:z===t._id})})]}),(0,m.jsx)("p",{className:"text-lg font-semibold text-gray-800 mb-4",children:t.title})]}),(0,m.jsxs)("a",{href:t.fileName,target:"_blank",rel:"noopener noreferrer",className:"w-full mt-2 inline-flex items-center justify-center gap-2 py-2 px-4 text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,m.jsx)(c.G,{icon:u.q7m}),"Download"]})]},t._id)}))}):(0,m.jsxs)("div",{className:"text-center bg-white p-10 rounded-lg shadow-sm",children:[(0,m.jsx)("h3",{className:"text-lg font-medium text-gray-800",children:"No Files Found"}),(0,m.jsx)("p",{className:"text-gray-500 mt-1",children:"There are currently no files available for download."})]})]})]})})}}}]);
//# sourceMappingURL=101.6a754439.chunk.js.map